{"version":3,"sources":["webpack://keksobooking/./source/js/ad.js","webpack://keksobooking/./source/js/api.js","webpack://keksobooking/./source/js/status-message.js","webpack://keksobooking/./source/js/util.js","webpack://keksobooking/./source/js/form-validation.js","webpack://keksobooking/./source/js/image-preview.js","webpack://keksobooking/./source/js/user-form.js","webpack://keksobooking/./source/js/filter.js","webpack://keksobooking/./source/js/map.js"],"names":["housingType","palace","flat","house","bungalow","removeBlock","block","innerHTML","remove","adTemplate","document","querySelector","content","getData","onSuccess","onFail","fetch","then","response","ok","json","ads","catch","main","getMessageElement","elemType","element","cloneNode","style","zIndex","classList","add","showMessage","status","statusMessage","closeMessage","onDocumentKeyDown","evt","cb","key","isEsc","removeEventListener","onDocumentClick","addEventListener","apartmentToPrice","roomNumberToCapacity","apartmentTitle","type","apartmentPrice","timeIn","timeOut","placeholder","value","setAttribute","roomNumber","capacity","capacityOptions","querySelectorAll","resetCapacity","forEach","disabled","selected","selectedIndex","setCustomValidity","border","validity","tooShort","tooLong","valueMissing","rangeUnderflow","getAttribute","rangeOverflow","FILE_TYPES","avatarChooser","avatarPreview","photoChooser","photoBlock","overflow","makeFileReader","chooser","preview","file","files","fileName","name","toLowerCase","some","it","endsWith","reader","FileReader","objectFit","src","result","readAsDataURL","photoPreview","createElement","width","height","alt","appendChild","resetPreviews","CITY_CENTER","lat","lng","adForm","adFormFieldsets","mapFilter","mapFilterChildren","children","address","setDisabledAttr","arr","elem","removeDisabledAttr","resetForm","form","mainMarker","setLatLng","reset","toFixed","preventDefault","renderAds","onSuccessUpload","onErrorUpload","formData","FormData","target","method","body","filters","houseTypeFilter","priceFilter","roomsFilter","guestsFilter","checkBoxWiFi","checkBoxDishwasher","checkBoxParking","checkBoxWasher","checkBoxElevator","checkBoxConditioner","filterToPrice","price","map","L","on","setView","tileLayer","attribution","addTo","mainMarkerIcon","icon","iconUrl","iconSize","iconAnchor","markerIcon","marker","draggable","coordinates","getLatLng","markers","createMarkers","resetMarkers","point","number","location","push","bindPopup","author","offer","adItem","featuresBlock","photosBlock","avatar","textContent","title","rooms","guests","checkin","checkout","features","feature","join","description","photos","photo","renderAdItem","keepInView","removeLayer","slicedAds","slice","renderAllMarkers","debouncedFilterChange","_","debounce","filteredData","filter","isHouseType","filterByHouseType","filterByPrice","isRoom","parseInt","filterByRooms","isGuests","filterByGuests","isWiFi","indexOf","isDishwasher","isParking","isWasher","isElevator","isConditioner","checked","filterByFeatures","message","mapBlock","alertContainer","append"],"mappings":"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","file":"main.bundle.js","sourcesContent":["const housingType = {\n  palace: 'Дворец',\n  flat: 'Квартира',\n  house: 'Дом',\n  bungalow: 'Бунгало',\n}\n\nconst removeBlock = (block) => {\n  if (block.innerHTML === '') {\n    block.remove();\n  }\n}\n\nconst adTemplate = document.querySelector('#card').content.querySelector('.popup');\n\nconst renderAdItem = ({ author, offer }) => {\n  const adItem = adTemplate.cloneNode(true);\n  const featuresBlock = adItem.querySelector('.popup__features');\n  const photosBlock = adItem.querySelector('.popup__photos');\n  adItem.querySelector('.popup__avatar').src = author.avatar;\n  adItem.querySelector('.popup__title').textContent = offer.title;\n  adItem.querySelector('.popup__text--address').textContent = offer.address;\n  adItem.querySelector('.popup__text--price').textContent = `${offer.price} ₽/ночь`;\n  adItem.querySelector('.popup__type').textContent = housingType[offer.type];\n  adItem.querySelector('.popup__text--capacity').textContent = `${offer.rooms} комнаты для ${offer.guests} гостей`;\n  adItem.querySelector('.popup__text--time').textContent = `Заезд после ${offer.checkin}, выезд до ${offer.checkout}`;\n  featuresBlock.innerHTML = offer.features\n    .map((feature) => `<li class=\"popup__feature popup__feature--${feature}\"></li>`)\n    .join('');\n  removeBlock(featuresBlock);\n  adItem.querySelector('.popup__description').textContent = offer.description;\n  photosBlock.innerHTML = offer.photos\n    .map((photo) => `<img src=\"${photo}\" class=\"popup__photo\" width=\"45\" height=\"40\" alt=\"Фотография жилья\">`)\n    .join('');\n  removeBlock(photosBlock);\n  return adItem;\n}\n\nexport { renderAdItem };\n","const GET_DATA_URL = 'https://22.javascript.pages.academy/keksobooking/data';\nconst SEND_DATA_URL = 'https://22.javascript.pages.academy/keksobooking';\n\nconst getData = (onSuccess, onFail) => {\n  fetch(GET_DATA_URL)\n    .then((response) => {\n      if (response.ok) {\n        return response.json();\n      } else {\n        onFail('Ошибка загрузки данных!');\n      }\n    })\n    .then((ads) => onSuccess(ads))\n    .catch(() => {\n      onFail('Ошибка загрузки данных!');\n    });\n};\n\nconst sendData = (onSuccess, onFail, body) => {\n  fetch(\n    SEND_DATA_URL,\n    {\n      method: 'POST',\n      body,\n    },\n  )\n    .then((response) => {\n      if (response.ok) {\n        onSuccess();\n      } else {\n        onFail();\n      }\n    })\n    .catch(() => {\n      onFail();\n    });\n};\n\nexport { getData, sendData };\n","import { isEsc } from './util.js';\n\nconst main = document.querySelector('main');\n\nconst getMessageElement = (elemType) => {\n  const elementTemplate = document.querySelector(`#${elemType}`).content.querySelector(`.${elemType}`);\n  const element = elementTemplate.cloneNode(true);\n  element.style.zIndex = 1100;\n  element.classList.add('hidden');\n  return element;\n}\n\nexport const renderMessageElements = () => {\n  main.appendChild(getMessageElement('success'));\n  main.appendChild(getMessageElement('error'));\n}\n\nexport const showMessage = (status) => {\n  const statusMessage = document.querySelector(`.${status}`);\n  statusMessage.classList.remove('hidden');\n  const closeMessage = () => statusMessage.classList.add('hidden');\n\n  const onDocumentKeyDown = (evt) => {\n    isEsc(evt, closeMessage);\n    document.removeEventListener('keydown', onDocumentKeyDown);\n    document.removeEventListener('click', onDocumentClick);\n  }\n\n  const onDocumentClick = () => {\n    closeMessage();\n    document.removeEventListener('keydown', onDocumentKeyDown);\n    document.removeEventListener('click', onDocumentClick);\n  }\n\n  document.addEventListener('keydown', onDocumentKeyDown);\n  document.addEventListener('click', onDocumentClick);\n}\n","const getRandomInteger = (minNumber, maxNumber) => {\n  const randomInteger = Math.round((Math.random() * (maxNumber - minNumber) + minNumber));\n  return Math.abs(randomInteger);\n};\n\nconst getRandomDecimal = (minNumber, maxNumber, decimalSymbols = 5) => {\n  const randomDecimal = (Math.random() * (maxNumber - minNumber) + minNumber);\n  return Math.abs(randomDecimal).toFixed(decimalSymbols);\n};\n\nconst getRandomArrayElement = (elements) => {\n  return elements[getRandomInteger(0, elements.length - 1)];\n};\n\nconst getRandomArray = (arr) => {\n  const randomArray = new Array(getRandomInteger(0, arr.length - 1)).fill(null).map(() => getRandomArrayElement(arr));\n  const result = [];\n  for (let value of randomArray) {\n    if (!result.includes(value)) {\n      result.push(value);\n    }\n  }\n  return result;\n};\n\nconst showAlert = (message) => {\n  const mapBlock = document.querySelector('.map');\n  const alertContainer = document.createElement('div');\n  alertContainer.classList.add('alert-message');\n  alertContainer.textContent = message;\n  mapBlock.append(alertContainer);\n}\n\nconst isEsc = (evt, cb) => {\n  if (evt.key === ('Escape' || 'Esc')) {\n    cb();\n  }\n}\n\nexport { getRandomInteger, getRandomDecimal, getRandomArrayElement, getRandomArray, showAlert, isEsc };\n","const apartmentToPrice = {\n  bungalow: 0,\n  flat: 1000,\n  house: 5000,\n  palace: 10000,\n}\n\nconst roomNumberToCapacity = {\n  '1': [2],\n  '2': [1, 2],\n  '3': [0, 1, 2],\n  '100': [3],\n}\n\nconst apartmentTitle = document.querySelector('#title');\nconst type = document.querySelector('#type');\nconst apartmentPrice = document.querySelector('#price');\nconst timeIn = document.querySelector('#timein');\nconst timeOut = document.querySelector('#timeout');\n\nconst onTypeChange = () => {\n  apartmentPrice.placeholder = apartmentToPrice[type.value];\n  apartmentPrice.setAttribute('min', apartmentToPrice[type.value]);\n}\n\ntype.addEventListener('change', onTypeChange);\n\nconst onTimeInChange = () => timeOut.value = timeIn.value;\nconst onTimeOutChange = () => timeIn.value = timeOut.value;\n\ntimeIn.addEventListener('change', onTimeInChange);\ntimeOut.addEventListener('change', onTimeOutChange);\n\nconst roomNumber = document.querySelector('#room_number');\nconst capacity = document.querySelector('#capacity');\nconst capacityOptions = capacity.querySelectorAll('option');\n\nconst resetCapacity = () => {\n  capacityOptions.forEach((capacity) => capacity.disabled = true);\n  if (roomNumber.value === '1') {\n    capacity[2].disabled = false;\n  }\n  capacity[2].selected = true;\n}\n\nconst onRoomNumberClick = () => {\n  resetCapacity();\n  capacity.selectedIndex = -1;\n  capacity.setCustomValidity('Необходимо выбрать количество гостей');\n  capacity.style.border = '3px solid red';\n  roomNumberToCapacity[roomNumber.value].forEach((selectedIndex) => capacity[selectedIndex].disabled = false);\n}\n\nconst onCapacityChange = () => {\n  capacity.setCustomValidity('');\n  capacity.style.border = 'none';\n}\n\nroomNumber.addEventListener('click', onRoomNumberClick);\ncapacity.addEventListener('change', onCapacityChange);\n\napartmentTitle.addEventListener('input', () => {\n  apartmentTitle.style.border = '3px solid red';\n  if (apartmentTitle.validity.tooShort) {\n    apartmentTitle.setCustomValidity('Заголовок объявления должен состоять минимум из 30 символов');\n  } else if (apartmentTitle.validity.tooLong) {\n    apartmentTitle.setCustomValidity('Заголовок объявления не должен превышать 100 символов');\n  } else if (apartmentTitle.validity.valueMissing) {\n    apartmentTitle.setCustomValidity('Обязательное для заполнения поле');\n  } else {\n    apartmentTitle.setCustomValidity('');\n    apartmentTitle.style.border = 'none';\n  }\n});\n\napartmentPrice.addEventListener('input', () => {\n  apartmentPrice.style.border = '3px solid red';\n  if (apartmentPrice.validity.rangeUnderflow) {\n    apartmentPrice.setCustomValidity(`Минимальная цена ${apartmentPrice.getAttribute('min')} руб.`);\n  } else if (apartmentPrice.validity.rangeOverflow) {\n    apartmentPrice.setCustomValidity(`Максимальная цена ${apartmentPrice.getAttribute('max')} руб.`);\n  } else if (apartmentPrice.validity.valueMissing) {\n    apartmentPrice.setCustomValidity('Обязательное для заполнения поле');\n  } else {\n    apartmentPrice.setCustomValidity('');\n    apartmentPrice.style.border = 'none';\n  }\n});\n\nconst resetFieldsStyle = () => {\n  apartmentTitle.style.border = 'none';\n  apartmentPrice.style.border = 'none';\n  capacity.style.border = 'none';\n}\n\nexport { resetCapacity, resetFieldsStyle };\n","const FILE_TYPES = ['gif', 'jpg', 'jpeg', 'png'];\n\nconst avatarChooser = document.querySelector('#avatar');\nconst avatarPreview = document.querySelector('.ad-form-header__preview img');\n\nconst photoChooser = document.querySelector('#images');\nconst photoBlock = document.querySelector('.ad-form__photo');\nphotoBlock.style.overflow = 'hidden';\n\nconst makeFileReader = (chooser, preview) => {\n  const file = chooser.files[0];\n  const fileName = file.name.toLowerCase();\n\n  const matches = FILE_TYPES.some((it) => {\n    return fileName.endsWith(it);\n  });\n\n  if (matches) {\n    const reader = new FileReader();\n\n    reader.addEventListener('load', () => {\n      preview.style.objectFit = 'cover';\n      preview.src = reader.result;\n    });\n\n    reader.readAsDataURL(file);\n  }\n}\n\nconst onAvatarPreviewChange = () => makeFileReader(avatarChooser, avatarPreview);\navatarChooser.addEventListener('change', onAvatarPreviewChange);\n\nconst onPhotoPreviewChange = () => {\n  photoBlock.innerHTML = '';\n  const photoPreview = document.createElement('img');\n  photoPreview.style.width = '100%';\n  photoPreview.style.height = '100%';\n  photoPreview.alt = 'Фотография жилья';\n  photoBlock.appendChild(photoPreview);\n  makeFileReader(photoChooser, photoPreview);\n}\n\nphotoChooser.addEventListener('change', onPhotoPreviewChange);\n\nconst resetPreviews = () => {\n  photoBlock.innerHTML = '';\n  avatarPreview.src = './img/muffin-grey.svg';\n}\n\nexport { resetPreviews };\n","import { sendData, getData } from './api.js';\nimport { mainMarker, renderAds } from './map.js';\nimport { showMessage } from './status-message.js';\nimport { resetCapacity, resetFieldsStyle } from './form-validation.js';\nimport { resetPreviews } from './image-preview.js';\n\nconst CITY_CENTER = {\n  lat: 35.85000,\n  lng: 139.76000,\n};\n\nconst adForm = document.querySelector('.ad-form');\nconst adFormFieldsets = adForm.querySelectorAll('fieldset');\nconst mapFilter = document.querySelector('.map__filters');\nconst mapFilterChildren = mapFilter.children;\nconst address = adForm.querySelector('#address');\n\nconst setDisabledAttr = (arr) => {\n  for (let elem of arr) {\n    elem.disabled = true;\n  }\n}\n\nconst removeDisabledAttr = (arr) => {\n  for (let elem of arr) {\n    elem.disabled = false;\n  }\n}\n\nconst blockPage = () => {\n  adForm.classList.add('ad-form--disabled');\n  setDisabledAttr(adFormFieldsets);\n  mapFilter.classList.add('.map__filters--disabled');\n  setDisabledAttr(mapFilterChildren);\n}\n\nblockPage();\n\nconst initMapFilter = () => {\n  mapFilter.classList.remove('.map__filters--disabled');\n  removeDisabledAttr(mapFilterChildren);\n}\n\nconst initAdForm = () => {\n  adForm.classList.remove('ad-form--disabled');\n  removeDisabledAttr(adFormFieldsets);\n  address.value = `${CITY_CENTER.lat.toFixed(5)}, ${CITY_CENTER.lng.toFixed(5)}`;\n  address.setAttribute('readonly', 'readonly');\n  resetCapacity();\n}\n\nconst resetForm = (form) => {\n  mainMarker.setLatLng([CITY_CENTER.lat, CITY_CENTER.lng]);\n  form.reset();\n  address.value = `${CITY_CENTER.lat.toFixed(5)}, ${CITY_CENTER.lng.toFixed(5)}`;\n  resetCapacity();\n  resetFieldsStyle();\n}\n\nconst buttonReset = adForm.querySelector('.ad-form__reset');\n\nbuttonReset.addEventListener('click', (evt) => {\n  evt.preventDefault();\n  resetForm(adForm);\n  resetForm(mapFilter);\n  resetPreviews();\n  getData(renderAds);\n});\n\nconst onSuccessUpload = () => {\n  showMessage('success');\n  resetForm(adForm);\n  resetForm(mapFilter);\n  resetPreviews();\n  getData(renderAds);\n}\n\nconst onErrorUpload = () => {\n  showMessage('error');\n}\n\nconst onFormSubmit = (evt) => {\n  evt.preventDefault();\n  const formData = new FormData(evt.target);\n  sendData(onSuccessUpload, onErrorUpload, formData);\n}\n\nadForm.addEventListener('submit', onFormSubmit);\n\nexport { CITY_CENTER, initAdForm, initMapFilter, address };\n","const PRICE = {\n  MIN: 10000,\n  MAX: 50000,\n}\n\nconst filters = document.querySelector('.map__filters');\n\nconst houseTypeFilter = filters.querySelector('#housing-type');\nconst priceFilter = filters.querySelector('#housing-price');\nconst roomsFilter = filters.querySelector('#housing-rooms');\nconst guestsFilter = filters.querySelector('#housing-guests');\n\nconst checkBoxWiFi = filters.querySelector('#filter-wifi');\nconst checkBoxDishwasher = filters.querySelector('#filter-dishwasher');\nconst checkBoxParking = filters.querySelector('#filter-parking');\nconst checkBoxWasher = filters.querySelector('#filter-washer');\nconst checkBoxElevator = filters.querySelector('#filter-elevator');\nconst checkBoxConditioner = filters.querySelector('#filter-conditioner');\n\nconst filterByHouseType = (elem) => {\n  let isHouseType = elem.offer.type === houseTypeFilter.value;\n  return houseTypeFilter.value === 'any' ? true : isHouseType;\n}\n\nconst filterToPrice = {\n  'any': (price) => price,\n  'low': (price) => price <= PRICE.MIN,\n  'high': (price) => price >= PRICE.MAX,\n  'middle': (price) => price >= PRICE.MIN && price <= PRICE.MAX,\n}\n\nconst filterByPrice = (elem) => {\n  let price = elem.offer.price;\n  return filterToPrice[priceFilter.value](price);\n}\n\nconst filterByRooms = (elem) => {\n  let isRoom = elem.offer.rooms === parseInt(roomsFilter.value, 10);\n  return roomsFilter.value === 'any' ? true : isRoom;\n}\n\nconst filterByGuests = (elem) => {\n  let isGuests = elem.offer.guests === parseInt(guestsFilter.value, 10);\n  return guestsFilter.value === 'any' ? true : isGuests;\n}\n\nconst filterByFeatures = (elem) => {\n  let isWiFi = elem.offer.features.indexOf('wifi') !== -1;\n  let isDishwasher = elem.offer.features.indexOf('dishwasher') !== -1;\n  let isParking = elem.offer.features.indexOf('parking') !== -1;\n  let isWasher = elem.offer.features.indexOf('washer') !== -1;\n  let isElevator = elem.offer.features.indexOf('elevator') !== -1;\n  let isConditioner = elem.offer.features.indexOf('conditioner') !== -1;\n\n  let result = true;\n\n  result = result && (checkBoxWiFi.checked ? isWiFi : true);\n  result = result && (checkBoxDishwasher.checked ? isDishwasher : true);\n  result = result && (checkBoxParking.checked ? isParking : true);\n  result = result && (checkBoxWasher.checked ? isWasher : true);\n  result = result && (checkBoxElevator.checked ? isElevator : true);\n  result = result && (checkBoxConditioner.checked ? isConditioner : true);\n\n  return result;\n}\n\nconst getFilteredPins = (data) => data.filter((elem) => {\n  return filterByHouseType(elem) &&\n    filterByPrice(elem) &&\n    filterByRooms(elem) &&\n    filterByGuests(elem) &&\n    filterByFeatures(elem)\n});\n\nexport { filters, getFilteredPins };\n","/* global L:readonly */\n/* global _:readonly */\nimport { renderAdItem } from './ad.js';\nimport { getData } from './api.js';\nimport { CITY_CENTER, initAdForm, initMapFilter, address } from './user-form.js';\nimport { showAlert } from './util.js';\nimport { filters, getFilteredPins } from './filter.js';\n\nconst SIMILAR_ADS_COUNT = 10;\nconst RERENDER_DELAY = 500;\n\nconst MAP_SCALE = 9;\n\nconst MAIN_MARKER_ICON_WIDTH = 52;\nconst MAIN_MARKER_ICON_HEIGHT = 52;\nconst MAIN_MARKER_ICON_ANCHOR_X = 26;\nconst MAIN_MARKER_ICON_ANCHOR_Y = 52;\n\nconst MARKER_ICON_WIDTH = 40;\nconst MARKER_ICON_HEIGHT = 40;\nconst MARKER_ICON_ANCHOR_X = 20;\nconst MARKER_ICON_ANCHOR_Y = 40;\n\nconst map = L.map('map-canvas')\n  .on('load', () => {\n    initAdForm();\n  })\n  .setView({\n    lat: CITY_CENTER.lat,\n    lng: CITY_CENTER.lng,\n  }, MAP_SCALE);\n\nL.tileLayer(\n  'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n  {\n    attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n  },\n).addTo(map);\n\nconst mainMarkerIcon = L.icon({\n  iconUrl: './img/main-pin.svg',\n  iconSize: [MAIN_MARKER_ICON_WIDTH, MAIN_MARKER_ICON_HEIGHT],\n  iconAnchor: [MAIN_MARKER_ICON_ANCHOR_X, MAIN_MARKER_ICON_ANCHOR_Y],\n});\n\nconst markerIcon = L.icon({\n  iconUrl: './img/pin.svg',\n  iconSize: [MARKER_ICON_WIDTH, MARKER_ICON_HEIGHT],\n  iconAnchor: [MARKER_ICON_ANCHOR_X, MARKER_ICON_ANCHOR_Y],\n});\n\nconst mainMarker = L.marker(\n  {\n    lat: CITY_CENTER.lat,\n    lng: CITY_CENTER.lng,\n  },\n  {\n    draggable: true,\n    icon: mainMarkerIcon,\n  },\n).addTo(map);\n\nmainMarker.on('moveend', (evt) => {\n  const coordinates = evt.target.getLatLng();\n  address.value = `${coordinates.lat.toFixed(5)}, ${coordinates.lng.toFixed(5)}`;\n});\n\nlet markers = [];\n\nconst createMarkers = (arr) => {\n  resetMarkers();\n\n  arr.forEach((point, number) => {\n    const { location } = point;\n\n    const marker = new L.marker(\n      {\n        lat: location.lat,\n        lng: location.lng,\n      },\n      {\n        icon: markerIcon,\n      });\n\n    markers.push(marker);\n\n    markers[number].addTo(map)\n      .bindPopup(\n        renderAdItem(point),\n        {\n          keepInView: true,\n        },\n      );\n  });\n}\n\nconst resetMarkers = () => {\n  markers.forEach((marker) => {\n    map.removeLayer(marker)\n  });\n  markers = [];\n}\n\nconst renderAllMarkers = (arr) => {\n\n  const slicedAds = arr.slice(0, SIMILAR_ADS_COUNT);\n  createMarkers(slicedAds);\n}\n\nconst renderAds = (ads) => {\n  renderAllMarkers(ads);\n\n  initMapFilter();\n\n  const onFiltersChange = () => {\n    let filteredData = getFilteredPins(ads);\n    filteredData = filteredData.slice(0, SIMILAR_ADS_COUNT);\n    createMarkers(filteredData);\n  }\n\n  const debouncedFilterChange = _.debounce(onFiltersChange, RERENDER_DELAY);\n  filters.addEventListener('change', debouncedFilterChange);\n}\n\ngetData(renderAds, showAlert);\n\nexport { mainMarker, resetMarkers, renderAds, createMarkers };\n"],"sourceRoot":""}